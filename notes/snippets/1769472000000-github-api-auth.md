---
title: GitHub API 認証スニペット
status: trashed
category: snippets
ai_outcome: keep
ai_reviewed: true
createdAt: '2026-01-27T01:00:00.000Z'
updatedAt: '2026-03-01T06:43:26.436Z'
---
## Octokit 初期化（OAuth トークン）

```ts
import { Octokit } from '@octokit/rest'

function getOctokit(token?: string) {
  return new Octokit({ auth: token ?? process.env.GITHUB_TOKEN })
}
```

## ファイル取得 & Base64 デコード

```ts
const { data } = await octokit.repos.getContent({
  owner: OWNER,
  repo: REPO,
  path: `notes/${category}/${id}.md`,
  ref: 'main',
})

if (Array.isArray(data) || data.type !== 'file') return null

const raw = Buffer.from(data.content, 'base64').toString('utf-8')
const { data: fm, content } = matter(raw)
```

## ファイル作成・更新

```ts
// 作成（sha なし）
await octokit.repos.createOrUpdateFileContents({
  owner, repo, path,
  message: `feat: add note "${title}"`,
  content: Buffer.from(fileContent).toString('base64'),
  branch: 'main',
})

// 更新（sha 必須）
await octokit.repos.createOrUpdateFileContents({
  owner, repo, path,
  message: `update: "${title}"`,
  content: Buffer.from(fileContent).toString('base64'),
  sha,   // 競合防止
  branch: 'main',
})
```

## ファイル削除

```ts
await octokit.repos.deleteFile({
  owner, repo, path,
  message: `delete: note ${id}`,
  sha,
  branch: 'main',
})
```
